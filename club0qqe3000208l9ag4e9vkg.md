---
title: "ë°±ì¤€ ìŠ¤íŠ¸ë¦­ ì„¸ì´ë²„ ì œì‘ê¸° ğŸª„"
seoTitle: "ë°±ì¤€ ìŠ¤íŠ¸ë¦­ ì„¸ì´ë²„ ì œì‘ê¸° ğŸª„"
seoDescription: "ì…ëŒ€ í›„ ë°±ì¤€ ìŠ¤íŠ¸ë¦­ì„ ìœ ì§€í•˜ê¸° ìœ„í•´, Playwrightì™€ Github Actionsë¥¼ í™œìš©í•œ ìë™ ì œì¶œ í”„ë¡œê·¸ë¨ì„ ì œì‘í•œ ê³¼ì •ì— ëŒ€í•´ ì†Œê°œí•©ë‹ˆë‹¤."
datePublished: Thu Mar 28 2024 09:14:51 GMT+0000 (Coordinated Universal Time)
cuid: club0qqe3000208l9ag4e9vkg
slug: boj-streak-saver
cover: https://cdn.hashnode.com/res/hashnode/image/upload/v1711612014906/01c1d792-702c-454d-8149-db8fec260e2b.png
tags: python, captcha, github-actions-1, playwright

---

## â˜ ï¸ ê°œë°œ ë°°ê²½

![](https://cdn.hashnode.com/res/hashnode/image/upload/v1711612034002/da20e60a-50d7-4833-a888-7fd612aac58b.png align="center")

ë‚˜ëŠ” ìˆ˜ëŠ¥ ì´í›„ë¶€í„° ì§€ê¸ˆê¹Œì§€ ë°±ì¤€ ìŠ¤íŠ¸ë¦­ì„ 2ë…„ ì´ìƒ ìœ ì§€í•˜ê³  ìˆë‹¤. ë¬¼ë¡  ì²˜ìŒì—ëŠ” ì•Œê³ ë¦¬ì¦˜ ì‹¤ë ¥ì„ ìŒ“ê² ë‹¤ëŠ” ëª©í‘œë¡œ ì‹œì‘í–ˆìœ¼ë‚˜, ì§€ê¸ˆì€ ë³¸ë§ì´ ì „ë„ë˜ì–´ ìŠ¤íŠ¸ë¦­ì„ ìŒ“ëŠ” ê²ƒ ìì²´ì— ë” ì¬ë¯¸ë¥¼ ëŠë¼ê³  ìˆë‹¤. (ë‹¹ì—°íˆ ì‹¤ë ¥ì€ ì œìë¦¬ê±¸ìŒì´ë‹¤.)

ì—¬í–‰ì„ ê°€ì„œë„ ë°±ì¤€ì„ í’€ê³  ì‹¬ì§€ì–´ íœ´ëŒ€í°ìœ¼ë¡œ ë‹µì•ˆì„ ì œì¶œí•˜ëŠ” ë“± ìŠ¤íŠ¸ë¦­ ìœ ì§€ë¥¼ ìœ„í•´ ê°–ì€ ìˆ˜ë¥¼ ì¼ì§€ë§Œ, ê·¸ëŸ¼ì—ë„ ì–´ì°Œí•  ìˆ˜ ì—†ëŠ” ê²ƒì´ ìˆì—ˆìœ¼ë‹ˆ ë°”ë¡œ [êµ°ëŒ€](https://roian6.hashnode.dev/army-tiger)ë‹¤. í›ˆë ¨ì†Œì—ì„œ ë§¤ì¼ ë°±ì¤€ì„ í’€ ìˆ˜ëŠ” ì—†ì§€ ì•Šì€ê°€?

ë”°ë¼ì„œ ë‚´ê°€ ë¬¼ë¦¬ì ìœ¼ë¡œ ë¬¸ì œë¥¼ í’€ ìˆ˜ ì—†ëŠ” ê¸°ê°„ì—ë„ ìŠ¤íŠ¸ë¦­ì„ ìœ ì§€í•  ìˆ˜ ìˆê²Œ ë„ì™€ì£¼ëŠ” í”„ë¡œê·¸ë¨ì„ ë§Œë“¤ê¸°ë¡œ ê²°ì‹¬í–ˆë‹¤. ì•Œê³ ë¦¬ì¦˜ ì‹¤ë ¥ì—ëŠ” í•˜ë“± ë„ì›€ì´ ì•ˆ ë˜ëŠ” ì‚¬ì§œê°™ì€ ë°œìƒì´ì§€ë§Œ ì–´ì©Œê² ëŠ”ê°€? 800 ìŠ¤íŠ¸ë¦­ì€ ì†”ì§íˆ ì¢€ ì•„ê¹Œìš´ ê±¸... ğŸ¤”

## âš™ï¸ ì„¤ê³„ ë° ì‚¬ìš© ê¸°ìˆ 

ì‚¬ìš© ì‹œë‚˜ë¦¬ì˜¤ë¥¼ ëŒ€ëµ êµ¬ìƒí•´ ë´¤ë‹¤.

1. ë¶€ê³„ì •ìœ¼ë¡œ ë¬¸ì œë¥¼ í’€ì–´ ì •ë‹µ ì½”ë“œë¥¼ ë‹¤ìˆ˜ í™•ë³´í•œë‹¤.
    
2. ì •ë‹µ ì½”ë“œë“¤ì„ í”„ë¡œê·¸ë¨ ì•ˆì— ë„£ì–´ ë‘”ë‹¤.
    
3. í”„ë¡œê·¸ë¨ì´ ë§¤ì¼ íŠ¹ì • ì‹œê°„ì— ë°±ì¤€ì— ë¬¸ì œë¥¼ í•˜ë‚˜ ì œì¶œí•œë‹¤.
    
4. ì œì¶œ ê²°ê³¼ì— ëŒ€í•œ ì•Œë¦¼ì„ ìŠ¬ë™ìœ¼ë¡œ ë°›ëŠ”ë‹¤.
    

ê°œë°œ ì–¸ì–´ëŠ” ìµìˆ™í•œ **íŒŒì´ì¬**ìœ¼ë¡œ ì •í–ˆë‹¤. ì›¹ ìë™í™” í”„ë ˆì„ì›Œí¬ëŠ” ì›ë˜ Seleniumì„ ì‚¬ìš©í–ˆì—ˆëŠ”ë°, ìš”ìƒˆëŠ” ë§ˆì´í¬ë¡œì†Œí”„íŠ¸ì—ì„œ ë§Œë“  [Playwright](https://playwright.dev/)ë¥¼ ë§ì´ ì“°ëŠ” ê²ƒ ê°™ì•„ ì´ë²ˆ ê¸°íšŒì— ì¨ë³´ê¸°ë¡œ í–ˆë‹¤.

í”„ë¡œê·¸ë¨ì€ [Github Actions](https://github.com/features/actions) ìœ„ì—ì„œ ëŒë¦¬ê¸°ë¡œ í–ˆë‹¤. ì„¸íŒ…ì´ ê°„í¸í•˜ê¸°ë„ í•˜ê³  ë¬´ë£Œì´ê¸° ë•Œë¬¸ì´ë‹¤.

![](https://cdn.hashnode.com/res/hashnode/image/upload/v1711609158282/777a2b32-2940-4b16-a352-3fe936f4530d.png align="left")

ìµœì¢… í”„ë¡œì íŠ¸ êµ¬ì¡°ëŠ” ìœ„ì™€ ê°™ë‹¤. Github Actionsì—ì„œ ì‹¤í–‰í•  ë‚´ìš©ì„ ë‹´ì€ `main.yml`, ì •ë‹µ ì†ŒìŠ¤ë“¤ì„ ë„£ì–´ë‘˜ `answers` í´ë”, ì‹¤ì œ í”„ë¡œê·¸ë¨ì„ ì‘ì„±í•  `program.py`ì™€ ì„¤ì¹˜í•´ì•¼ í•  íŒŒì´ì¬ íŒ¨í‚¤ì§€ë“¤ì„ ë‚˜ì—´í•œ `requirements.txt` íŒŒì¼ë¡œ êµ¬ì„±ë˜ì–´ ìˆë‹¤.

## ğŸ’» ê°œë°œ ê³¼ì •

*ì‹¤ì œ ê°œë°œ ìˆœì„œì™€ëŠ” ë‹¤ì†Œ ì°¨ì´ê°€ ìˆë‹¤.*

### íŒŒì´ì¬ í”„ë¡œê·¸ë¨ (program.py)

1. ë¨¼ì € ë¸Œë¼ìš°ì €ë¥¼ ì—´ê³  ë°±ì¤€ ì‚¬ì´íŠ¸ì— ì§„ì…í•˜ì—¬ ë¡œê·¸ì¸ì„ í•´ì•¼ í•œë‹¤. Playwrightë¥¼ ì´ìš©í•´ ë¸Œë¼ìš°ì €ë¥¼ ëŒ€ê°• ì„¸íŒ…í•˜ê³ , ë¡œê·¸ì¸ í˜ì´ì§€ë¡œ ì´ë™ì‹œì¼°ë‹¤.
    

```python
page.goto("https://www.acmicpc.net/login")
```

![](https://cdn.hashnode.com/res/hashnode/image/upload/v1711613178535/20427e42-1b0e-4b6a-93a4-2d2193182079.png align="center")

---

2. ì•„ì´ë””ì™€ íŒ¨ìŠ¤ì›Œë“œë¥¼ ì…ë ¥í•˜ê³  ë¡œê·¸ì¸ ë²„íŠ¼ì„ ëˆ„ë¥¸ë‹¤.
    

```python
page.fill('[name=login_user_id]', USER_ID)
page.fill('[name=login_password]', USER_PW)
page.click('[id=submit_button]')
```

![](https://cdn.hashnode.com/res/hashnode/image/upload/v1711613388888/e5e4e299-6c92-45a2-b894-6769a099fa7d.png align="center")

ì—¬ê¸°ì„œ ë¬¸ì œê°€ ìƒê²¼ë‹¤. ë°±ì¤€ ë¡œê·¸ì¸ í˜ì´ì§€ì— ìº¡ì°¨(reCAPTCHA v2 Invisible)ê°€ ì ìš©ë˜ì–´ ìˆì–´ ê°„í—ì ìœ¼ë¡œ ë¡œê·¸ì¸ì— ì‹¤íŒ¨í•˜ëŠ” ìƒí™©ì´ ë°œìƒí–ˆë‹¤.

í”„ë¡œê·¸ë¨ ì‹¤í–‰ ì‹¤íŒ¨ëŠ” ê³§ ìŠ¤íŠ¸ë¦­ ê¹¨ì§ìœ¼ë¡œ ì´ì–´ì§€ê¸° ë•Œë¬¸ì— ìº¡ì°¨ëŠ” ë°˜ë“œì‹œ í•´ê²°í•´ì•¼ í•  ê³¼ì œê°€ ë˜ì—ˆë‹¤.

---

3. ìº¡ì°¨ë¥¼ ìš°íšŒí•  ë°©ë²•ì„ ì°¾ë‹¤ [playwright\_recaptcha](https://pypi.org/project/playwright-recaptcha/) íŒ¨í‚¤ì§€ë¥¼ ë°œê²¬í–ˆë‹¤. ìº¡ì°¨ì˜ 'ìŒì„±ìœ¼ë¡œ ë“£ê¸°' ì˜µì…˜ì„ í†µí•´ STTë¡œ í•´ì„í•˜ê±°ë‚˜, [CapSolver](https://www.capsolver.com/)ê°€ ì œê³µí•˜ëŠ” ì´ë¯¸ì§€ ì‹ë³„ ê¸°ëŠ¥ì„ í†µí•´ ìº¡ì°¨ë¥¼ í•´ë…í•˜ëŠ” ì‘ì—…ì´ ê°€ëŠ¥í•˜ë”ë¼.
    

```python
with recaptchav2.SyncSolver(page) as solver:
    solver.solve_recaptcha(wait=True, wait_timeout=10)
```

ì—¬ê¸°ì„œ ì‹œí–‰ì°©ì˜¤ê³¼ ì‹œê°„ ì†Œìš”ê°€ ì œì¼ ë§ì•˜ë‹¤. ë¨¼ì € í•´ë‹¹ íŒ¨í‚¤ì§€ëŠ” ì•„ì§ í•œêµ­ì–´ë¥¼ ì§€ì›í•˜ì§€ ì•ŠëŠ”ë°, ë°±ì¤€ ì‚¬ì´íŠ¸ì—ì„œ ê¸°ë³¸ì ìœ¼ë¡œ í•œê¸€ ìº¡ì°¨ê°€ ë³´ì—¬ì§€ë¯€ë¡œ ë¸Œë¼ìš°ì €ì˜ `locale`ì„ ì˜ì–´ê¶Œìœ¼ë¡œ ë³€ê²½í•´ì•¼ í–ˆë‹¤.

```python
context = browser.new_context(locale='en-US')
```

ë˜í•œ í”„ë¡œê·¸ë¨ì„ headless ë¸Œë¼ìš°ì €(í™”ë©´ì— ë³´ì´ì§€ ì•Šê³  ë°±ê·¸ë¼ìš´ë“œì—ì„œ ëŒì•„ê°€ëŠ” ë¸Œë¼ìš°ì €)ë¡œ ì‹¤í–‰í•´ì•¼ í•˜ëŠ”ë°, í¬ë¡¬ ë¸Œë¼ìš°ì €ë¥¼ headless ëª¨ë“œë¡œ ì‚¬ìš©í•  ê²½ìš° ìº¡ì°¨ì—ì„œ ë¬´í•œë¡œë”©ì´ ë°œìƒí•˜ëŠ” ë¬¸ì œê°€ ìˆì—ˆë‹¤. ë”°ë¼ì„œ ë¸Œë¼ìš°ì €ë¥¼ Firefoxë¡œ ë³€ê²½í–ˆë‹¤.

```python
browser = playwright.firefox.launch(headless=True)
```

ë§ˆì§€ë§‰ìœ¼ë¡œ reCAPTCHAì˜ ìŒì„±ìœ¼ë¡œ ë“£ê¸° ì˜µì…˜ì€ ì¼ì • íšŸìˆ˜ ì´ìƒ ì‚¬ìš©í•˜ë©´ ë¶€ì ì ˆí•œ ìš”ì²­ìœ¼ë¡œ íŒë³„ë˜ì–´ ì°¨ë‹¨ë‹¹í•˜ê²Œ ëœë‹¤. ë”°ë¼ì„œ í•´ë‹¹ ì˜µì…˜ì„ ì‹œë„í•œ ë’¤ ì‹¤íŒ¨í•  ê²½ìš° ì´ë¯¸ì§€ ì‹ë³„ë¡œ ì¬ì‹œë„í•˜ëŠ” ë¡œì§ì„ ì¶”ê°€í•´ì•¼ í–ˆë‹¤.

```python
def login(page: Page, is_first: bool):
    (submit login info...)
    try:
        if is_first:
            with recaptchav2.SyncSolver(page) as solver:
                solver.solve_recaptcha(wait=True, wait_timeout=10)
        else:
            with recaptchav2.SyncSolver(page, capsolver_api_key=CAPSOLVER_KEY) as solver:
                solver.solve_recaptcha(wait=True, wait_timeout=10, image_challenge=True)
    except RecaptchaRateLimitError as e:
        if is_first:
            login(page, is_first=False)
        else:
            raise e
```

[CapSolver](https://www.capsolver.com/)ë¥¼ í†µí•œ ì´ë¯¸ì§€ ì‹ë³„ ê¸°ëŠ¥ì€ ìœ ë£Œì´ë©° API í‚¤ê°€ í•„ìš”í•˜ë‚˜, ê°€ê²©ì€ ìš”ì²­ 1000íšŒ ë‹¹ 400~800ì› ê¼´ë¡œ ë§¤ìš° ì €ë ´í•˜ë©° ê°€ì… ì‹œ 1$ë¥¼ ì§€ê¸‰í•˜ë¯€ë¡œ ë¬´ë£Œ ë²”ìœ„ ë‚´ì—ì„œ ë¬¸ì œ ì—†ì´ ì‚¬ìš©í•  ìˆ˜ ìˆë‹¤.

ì´ë ‡ê²Œ ìº¡ì°¨ ë¬¸ì œë¥¼ í•´ê²°í•  ìˆ˜ ìˆì—ˆë‹¤. ì—­ì‹œ ê¸°ìˆ ë¡œ ì•ˆ ë˜ëŠ” ê±´ ì—†êµ¬ë‚˜ ì‹¶ë”ë¼.

---

4. ì •ë‹µ ì†ŒìŠ¤ ëª©ë¡ì—ì„œ í•˜ë‚˜ë¥¼ ì„ì˜ë¡œ ì„ íƒí•˜ì—¬ ê°€ì ¸ì˜¨ë‹¤.
    

```python
answer_files = os.listdir('answers')
if not answer_files:
    raise NoAnswerError(message='ë‚¨ì€ ë‹µì•ˆì´ ì—†ì–´ ì œì¶œì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤.')

answer_file = str(random.choice(answer_files))
problem_number = answer_file[:answer_file.find('.')]
answer_code = open('answers/' + answer_file, 'r').read()
```

---

5. ì œì¶œ ì°½ìœ¼ë¡œ ì´ë™í•´ ë¬¸ì œë¥¼ ì œì¶œí•œë‹¤.
    

```python
page.goto(f'https://www.acmicpc.net/submit/{problem_number}')
page.evaluate('code => document.querySelector(".CodeMirror").CodeMirror.setValue(code)', answer_code)
page.click('[id=submit_button]')
```

![](https://cdn.hashnode.com/res/hashnode/image/upload/v1711615536295/408950d3-0807-4c3b-be81-08cd524a95c9.png align="center")

6. ì±„ì  ê²°ê³¼ë¥¼ ê¸°ë‹¤ë¦°ë‹¤.
    

```python
result_node = page.locator('#status-table tbody tr:first-child .result-text:not(.result-wait, .result-compile, .result-judging)')
result_text = result_node.text_content()
result_class = str(result_node.evaluate("node => node.className"))
```

ì±„ì  ê²°ê³¼ í…Œì´ë¸”ì—ì„œ ì²« ë²ˆì§¸ì— ìˆëŠ” ê²°ê³¼ê°€ 'ê¸°ë‹¤ë¦¬ëŠ” ì¤‘', 'ì±„ì  ì¤‘' ë“±ì˜ ë¡œë”© ìƒíƒœê°€ ì•„ë‹ˆê²Œ ë  ë•Œ ê¹Œì§€ ê¸°ë‹¤ë ¸ë‹¤ê°€ ê²°ê³¼ê°’ì„ ë°›ì•„ì˜¤ë„ë¡ í–ˆë‹¤. (PlaywrightëŠ” ì•„ì´í…œì„ íƒìƒ‰í•˜ê±°ë‚˜ í´ë¦­í•˜ëŠ” ë“±ì˜ ì‘ì—…ì„ ì‹¤í–‰í•˜ë©´ ê·¸ ì•„ì´í…œì´ í™”ë©´ì— ë‚˜íƒ€ë‚  ë•Œê¹Œì§€ ìë™ìœ¼ë¡œ ê¸°ë‹¤ë ¤ ì¤€ë‹¤.)

---

7. ì±„ì  ê²°ê³¼ì™€ ë‚¨ì€ ë¬¸ì œì˜ ìˆ˜ë¥¼ ìŠ¬ë™ìœ¼ë¡œ ì „ì†¡í•˜ê³ , ì œì¶œí•œ ë¬¸ì œ íŒŒì¼ì€ ì‚­ì œí•œë‹¤.
    

```python
        is_ac = 'ac' in result_class
        slack_message += 'ACë¥¼ ë°›ì•˜ìŠµë‹ˆë‹¤!' if is_ac else 'ACë¥¼ ë°›ì§€ ëª»í–ˆìŠµë‹ˆë‹¤.'

        os.remove('answers/' + answer_file)
        answer_left = len(answer_files) - 1

        slack_message += f' \nì±„ì  ê²°ê³¼: {result_text} \në‚¨ì€ ë¬¸ì œëŠ” {answer_left}ê°œì…ë‹ˆë‹¤.'

        if answer_left:
            hook_slack(slack_message, important=not is_ac)
        else:
            hook_slack(slack_message + '\n\në‚¨ì€ ë¬¸ì œê°€ ì—†ìŠµë‹ˆë‹¤!', important=True)
```

ë§Œì•½ í´ë”ì— ë‚¨ì€ ë¬¸ì œê°€ ì—†ê±°ë‚˜, ACë¥¼ ë°›ì§€ ëª»í•˜ëŠ” ë“± ìŠ¤íŠ¸ë¦­ì— ì˜í–¥ì„ ì¤„ ìˆ˜ ìˆëŠ” ë¬¸ì œê°€ ë°œìƒí•  ê²½ìš° ìŠ¬ë™ ë©”ì‹œì§€ ì•ì— \[ì¤‘ìš”\] ë¬¸êµ¬ë¥¼ ë¶™ì´ë„ë¡ ì„¤ì •í•´ ë‘ì—ˆë‹¤.

![](https://cdn.hashnode.com/res/hashnode/image/upload/v1711616467505/502ef404-1d29-4c99-869b-dbb9317319a2.png align="center")

ì´ë ‡ê²Œ ì½”ë“œ ìë™ ì œì¶œ ê¸°ëŠ¥ì˜ êµ¬í˜„ì„ ì™„ë£Œí–ˆë‹¤.

---

ì „ì²´ ì½”ë“œëŠ” ì•„ë˜ì™€ ê°™ë‹¤.

```python
import os
import sys
import random
import traceback
from datetime import datetime, timedelta
from requests import post, Response
from playwright.sync_api import BrowserContext, sync_playwright, Page
from playwright_recaptcha import recaptchav2, RecaptchaNotFoundError, RecaptchaRateLimitError

USER_ID = sys.argv[1]
USER_PW = sys.argv[2]

SLACK_API_URL = "https://slack.com/api/chat.postMessage"

SLACK_BOT_TOKEN = sys.argv[3]
SLACK_CHANNEL = sys.argv[4]

CAPSOLVER_KEY = sys.argv[5]


class NoAnswerError(Exception):
    def __init__(self, message="An error occurred", code=None):
        self.message = message
        self.code = code
        super().__init__(self.message)

    def __str__(self):
        return f"{self.message} - Code: {self.code}" if self.code else self.message


def __get_now() -> datetime:
    now_utc = datetime.utcnow()
    korea_timezone = timedelta(hours=9)
    now_korea = now_utc + korea_timezone
    return now_korea


def hook_slack(message: str, important=False) -> Response:
    korea_time_str = __get_now().strftime("%Y-%m-%d %H:%M:%S")
    payload = {
        "text": f"> {'[ì¤‘ìš”] ' if important else ''}{korea_time_str} *ë°±ì¤€ ìŠ¤íŠ¸ë¦­ ë´‡* \n{message}",
        "channel": SLACK_CHANNEL,
    }
    headers = {
        "Content-Type": "application/json",
        "Authorization": f"Bearer {SLACK_BOT_TOKEN}",
    }
    print(message)
    res = post(SLACK_API_URL, json=payload, headers=headers)
    return res


def login(page: Page, is_first: bool):
    print('navigating to login page...')
    if is_first:
        print('(might take long, due to browser setup)')
    page.goto("https://www.acmicpc.net/login")
    print('success!\n')

    print('submitting login info...')
    page.fill('[name=login_user_id]', USER_ID)
    page.fill('[name=login_password]', USER_PW)
    page.click('[id=submit_button]')
    print('success!\n')

    try:
        if is_first:
            with recaptchav2.SyncSolver(page) as solver:
                print('trying captcha...')
                solver.solve_recaptcha(wait=True, wait_timeout=10)
        else:
            with recaptchav2.SyncSolver(page, capsolver_api_key=CAPSOLVER_KEY) as solver:
                print('retrying captcha with image...')
                solver.solve_recaptcha(wait=True, wait_timeout=10, image_challenge=True)
        print('success!\n')
    except RecaptchaNotFoundError:
        print('success! no captcha found.\n')
    except RecaptchaRateLimitError as e:
        if is_first:
            print('rate limit, retry with image.\n')
            login(page, is_first=False)
        else:
            print('retry also failed.\n')
            raise e
    except Exception as e:
        if 'detached' in str(e):
            print('success! no captcha found. (detached)\n')
        else:
            raise e


def run(ctx: BrowserContext) -> None:
    try:
        print('loading answers...')
        answer_files = os.listdir('answers')
        if not answer_files:
            print('no answer left.\n')
            raise NoAnswerError(message='ë‚¨ì€ ë‹µì•ˆì´ ì—†ì–´ ì œì¶œì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤.')

        answer_file = str(random.choice(answer_files))
        problem_number = answer_file[:answer_file.find('.')]
        answer_code = open('answers/' + answer_file, 'r').read()
        print(f'success! {answer_file} selected.\n')

        slack_message = f'ì œì¶œ ë¬¸ì œëŠ” https://www.acmicpc.net/problem/{problem_number} ì…ë‹ˆë‹¤.\n\n'

        page = ctx.new_page()

        login(page, is_first=True)

        print('waiting home page to load...')
        page.wait_for_url("https://www.acmicpc.net/")
        print('success!\n')

        print('navigating to submit page...')
        page.goto(f'https://www.acmicpc.net/submit/{problem_number}')
        print('success!\n')

        print('submitting answer...')
        page.evaluate('code => document.querySelector(".CodeMirror").CodeMirror.setValue(code)', answer_code)
        page.click('[id=submit_button]')
        print('success!\n')

        print('waiting for result...')
        result_node = page.locator(
            '#status-table tbody tr:first-child .result-text:not(.result-wait, .result-compile, .result-judging)')
        result_text = result_node.text_content()
        result_class = str(result_node.evaluate("node => node.className"))
        print('success!\n')

        is_ac = 'ac' in result_class
        slack_message += 'ACë¥¼ ë°›ì•˜ìŠµë‹ˆë‹¤!' if is_ac else 'ACë¥¼ ë°›ì§€ ëª»í–ˆìŠµë‹ˆë‹¤.'

        os.remove('answers/' + answer_file)
        answer_left = len(answer_files) - 1

        slack_message += f' \nì±„ì  ê²°ê³¼: {result_text} \në‚¨ì€ ë¬¸ì œëŠ” {answer_left}ê°œì…ë‹ˆë‹¤.'

        if answer_left:
            hook_slack(slack_message, important=not is_ac)
        else:
            hook_slack(slack_message + '\n\në‚¨ì€ ë¬¸ì œê°€ ì—†ìŠµë‹ˆë‹¤!', important=True)

    except NoAnswerError as e:
        hook_slack(message=e.message, important=True)
    except Exception:
        hook_slack(traceback.format_exc(), important=True)
    finally:
        context.close()
        browser.close()


with sync_playwright() as playwright:
    browser = playwright.firefox.launch(headless=True)
    context = browser.new_context(locale='en-US')
    context.set_default_timeout(300000)
    run(context)
```

---

### Github Actions ì›Œí¬í”Œë¡œ (main.yml)

1. ë§¤ì¼ ì •í•´ì§„ ì‹œê°„ì— í”„ë¡œê·¸ë¨ì´ ì‹¤í–‰ë˜ê²Œ í•  í•„ìš”ê°€ ìˆë‹¤. ì´ëŠ” Github Actionsì˜ [`schedule`](https://docs.github.com/en/actions/using-workflows/events-that-trigger-workflows#schedule) ì´ë²¤íŠ¸ë¥¼ ì‚¬ìš©í•˜ì—¬ êµ¬í˜„í–ˆë‹¤.
    

```yaml
name: BOJ Streak Bot

on:
  schedule:
    - cron: "50 11 * * *" # UST 11:50 -> KST 20:50
  workflow_dispatch:
```

cron ë¬¸ë²•ìœ¼ë¡œ `"50 11 * * *"` ëŠ” ë§¤ì¼ 11ì‹œ 50ë¶„ì— ì‘ì—…ì„ ì‹¤í–‰í•œë‹¤ëŠ” ì˜ë¯¸ì´ë‹¤. Github ActionsëŠ” UTC ê¸°ì¤€ìœ¼ë¡œ ë™ì‘í•˜ë¯€ë¡œ í•œêµ­ ì‹œê°„(UTC+9) ê¸°ì¤€ ì˜¤í›„ 8ì‹œ 50ë¶„ì— ì‹¤í–‰ë˜ëŠ” ì…ˆì´ë‹¤. (cron ë¬¸ë²•ì— ëŒ€í•´ ë” ì•Œì•„ë³´ê³  ì‹¶ë‹¤ë©´ [https://crontab.guru/](https://crontab.guru/)ë¥¼ ì°¸ê³ í•  ìˆ˜ ìˆë‹¤.)

ì™œ 9ì‹œ ì •ê°ìœ¼ë¡œ ì„¤ì •í•˜ì§€ ì•ŠëŠ”ì§€ ì˜ì•„í•  ìˆ˜ ìˆìœ¼ë‚˜, Github ActionsëŠ” ë¬´ë£Œë¡œ ì œê³µë˜ë©° ì „ ì„¸ê³„ì—ì„œ ì‚¬ìš©í•˜ë¯€ë¡œ ì‚¬ëŒë“¤ì´ ëª°ë¦¬ëŠ” ì‹œê°„ì—ëŠ” ìš”ì²­ì´ í¬ê²Œ ì§€ì—°ëœë‹¤. ë”°ë¼ì„œ ì—¬ìœ  ìˆê²Œ 10ë¶„ ì „ì— ì‹¤í–‰í•˜ëŠ” ê²ƒì´ ì¢‹ë‹¤.

---

2. ì‹¤í–‰ í™˜ê²½ì„ ì„¸íŒ…í•œë‹¤. í”„ë¡œì íŠ¸ íŒŒì¼ì„ ë¶ˆëŸ¬ì˜¤ê³ , í”„ë¡œê·¸ë¨ ì‹¤í–‰ì— í•„ìš”í•œ íŒŒì´ì¬ ë° ê´€ë ¨ íŒ¨í‚¤ì§€ë“¤ì„ ì„¤ì¹˜í•´ì¤€ë‹¤.
    

```yaml
jobs:
  build:
    runs-on: ubuntu-latest
    strategy:
      matrix:
        python-version: [ 3.11 ]

    steps:
      - uses: actions/checkout@v4
        with:
          persist-credentials: false
          fetch-depth: 0

      - name: Set up python ${{ matrix.python-version }}
        uses: actions/setup-python@v5
        with:
          python-version: ${{ matrix.python-version }}
          cache: 'pip'

      - name: Install python package
        run: |
          python -m pip install --upgrade pip
          pip install -r requirements.txt

      - name: Ensure browsers are installed
        run: python -m playwright install --with-deps
```

`checkout` ì•¡ì…˜ì„ ì´ìš©í•´ ìš°ë¶„íˆ¬ í™˜ê²½ì—ë‹¤ ë ˆí¬ì§€í† ë¦¬ì˜ ë‚´ìš©ì„ ë³µì‚¬í•˜ê³ , `setup-python` ì•¡ì…˜ì„ í†µí•´ íŒŒì´ì¬ 3.11 ë²„ì „ì„ ì„¤ì¹˜í–ˆë‹¤. ê·¸ ë‹¤ìŒ `requirements.txt`ì— ëª…ì‹œí•œ íŒŒì´ì¬ íŒ¨í‚¤ì§€ë“¤ì„ ì„¤ì¹˜í•˜ê³ , `playwright install` ëª…ë ¹ì–´ë¥¼ í†µí•´ Playwright ì‚¬ìš©ì— í•„ìš”í•œ ì¶”ê°€ íŒŒì¼ë“¤ì„ ì„¤ì¹˜í–ˆë‹¤.

---

3. í”„ë¡œê·¸ë¨ì„ ì‹¤í–‰í•œë‹¤.
    

```yaml
      - name: Run program
        run: |
          python -u ./program.py ${{secrets.USER_ID}} ${{secrets.USER_PW}} ${{secrets.SLACK_BOT_TOKEN}} ${{secrets.SLACK_CHANNEL}} ${{secrets.CAPSOLVER_KEY}}
```

![](https://cdn.hashnode.com/res/hashnode/image/upload/v1711611612781/0814ecee-1d8d-484b-9bb0-d33c26412b2e.png align="center")

ë¯¼ê°í•œ ê°’ë“¤(ë°±ì¤€ ì•„ì´ë””, íŒ¨ìŠ¤ì›Œë“œ, ìŠ¬ë™ í† í° ë“±)ì€ ë ˆí¬ì§€í† ë¦¬ ë‚´ì˜ `Secrets`ì— ë³´ê´€í•˜ê³  ìˆë‹¤ê°€ í”„ë¡œê·¸ë¨ ì‹¤í–‰ ì‹œ ì „ë‹¬í•˜ë„ë¡ í•˜ì˜€ë‹¤.

---

4. ë³€ê²½ì‚¬í•­ì„ ë ˆí¬ì§€í† ë¦¬ì— ì €ì¥í•œë‹¤.
    

```yaml
      - name: Commit files
        run: |
          git config --local user.email "41898282+github-actions[bot]@users.noreply.github.com"
          git config --local user.name "github-actions[bot]"
          git commit -a -m "Remove uploaded answer"

      - name: Push changes
        uses: ad-m/github-push-action@master
        with:
          github_token: ${{ secrets.GITHUB_TOKEN }}
          branch: ${{ github.ref }}
```

í”„ë¡œê·¸ë¨ì´ ì •ìƒì ìœ¼ë¡œ ì‹¤í–‰ë˜ê³  ë‚˜ë©´ ì œì¶œ ì™„ë£Œí•œ ë¬¸ì œëŠ” í´ë”ì—ì„œ ì‚­ì œëœë‹¤. ì´ë¥¼ ì›ë³¸ ë ˆí¬ì§€í† ë¦¬ì— ë°˜ì˜í•˜ê¸° ìœ„í•´ ì»¤ë°‹ê³¼ í‘¸ì‹œ(`github-push-action` ì•¡ì…˜ ì‚¬ìš©)ë¥¼ ì§„í–‰í•œë‹¤.

![](https://cdn.hashnode.com/res/hashnode/image/upload/v1711612405725/9f50373b-a36c-45a8-9b84-a9427fd9b466.png align="left")

ì¬ë°ŒëŠ” íŒì´ ìˆëŠ”ë°, ì»¤ë°‹ ì‹œ ìœ ì € ì´ë©”ì¼ì„ `41898282+github-actions[bot]@users.noreply.github.com` ë¡œ ì„¤ì •í•˜ë©´ ìœ„ì™€ ê°™ì´ ê³µì‹ ë´‡ì´ ì»¤ë°‹í•œ ê²ƒì²˜ëŸ¼ í‘œì‹œëœë‹¤.

---

ì „ì²´ ì½”ë“œëŠ” ë‹¤ìŒê³¼ ê°™ë‹¤.

```yaml
name: BOJ Streak Bot

on:
  schedule:
    - cron: "50 11 * * *" # UST 11:50 -> KST 20:50
  workflow_dispatch:

jobs:
  build:
    runs-on: ubuntu-latest
    strategy:
      matrix:
        python-version: [ 3.11 ]

    steps:
      - uses: actions/checkout@v4
        with:
          persist-credentials: false
          fetch-depth: 0

      - name: Set up python ${{ matrix.python-version }}
        uses: actions/setup-python@v5
        with:
          python-version: ${{ matrix.python-version }}
          cache: 'pip'

      - name: Install python package
        run: |
          python -m pip install --upgrade pip
          pip install -r requirements.txt

      - name: Ensure browsers are installed
        run: python -m playwright install --with-deps

      - name: Run program
        run: |
          python -u ./program.py ${{secrets.USER_ID}} ${{secrets.USER_PW}} ${{secrets.SLACK_BOT_TOKEN}} ${{secrets.SLACK_CHANNEL}} ${{secrets.CAPSOLVER_KEY}}

      - name: Commit files
        run: |
          git config --local user.email "41898282+github-actions[bot]@users.noreply.github.com"
          git config --local user.name "github-actions[bot]"
          git commit -a -m "Remove uploaded answer"

      - name: Push changes
        uses: ad-m/github-push-action@master
        with:
          github_token: ${{ secrets.GITHUB_TOKEN }}
          branch: ${{ github.ref }}
```

## ğŸ¤” í›„ê¸°

ì™„ì„±ê¹Œì§€ ì´í‹€ ì •ë„ ê±¸ë ¸ë‹¤. ê¸°ëŠ¥ êµ¬í˜„ ìì²´ëŠ” ì²«ë‚ ì— ë§ˆì³¤ëŠ”ë°, ìº¡ì°¨ ê´€ë ¨ ì´ìŠˆë¡œ ì‚½ì§ˆì„ í•˜ëŠë¼ ì‹œê°„ì´ ì¢€ ë§ì´ ì†Œìš”ëë‹¤. ì´ì œ ë©°ì¹  ê°„ ëŒë ¤ë³´ë©´ì„œ í…ŒìŠ¤íŠ¸í•  ì˜ˆì •ì´ë‹¤. ì˜¤ëœ ê¸°ê°„ ë™ì•ˆ ìƒê°ëŒ€ë¡œ ì˜ ì‘ë™í• ì§€ ê¸°ëŒ€ê°€ ëœë‹¤.

í˜„ì¬ ë ˆí¬ì§€í† ë¦¬ëŠ” privateìœ¼ë¡œ í•´ ë‘ì—ˆëŠ”ë°, í˜¹ì‹œë‚˜ í•„ìš”í•œ ì‚¬ëŒì´ ìˆë‹¤ë©´ publicìœ¼ë¡œ ì „í™˜í•  ìƒê°ì´ ìˆë‹¤. ê·¼ë° ì´ ì •ë„ë¡œ ìŠ¤íŠ¸ë¦­ì— ì§‘ì°©í•˜ëŠ” ì‚¬ëŒì€ ì˜ ì—†ì§€ ì•Šì„ê¹Œ...

ë‹¤ìŒì€ ê°œë°œì— ì°¸ê³ í•œ í”„ë¡œì íŠ¸ë“¤ì´ë‹¤.

* [https://github.com/xhdtlsid2/boj-streak-keeper](https://github.com/xhdtlsid2/boj-streak-keeper)
    
* [https://github.com/blurfx/BOJ-AutoSubmit](https://github.com/blurfx/BOJ-AutoSubmit)
    
* [https://github.com/Nuung/auto-lotto-gitaction](https://github.com/Nuung/auto-lotto-gitaction)